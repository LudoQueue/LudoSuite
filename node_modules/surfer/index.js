var surf_socket = null;
var all_sockets = null;

exports.config_all = function(sockets) {
	all_sockets = sockets;
};

exports.config_surf = function(socket) {
	if(surf_socket == null) {
		surf_socket = socket;
		socket.on('disconnect', function() {
			surf_socket = null;
			all_sockets.emit('fail', {message: 'The game has closed'});
		});
	}
	else {
		socket.emit('fail', {message: 'A game already exists'});
	}
}

exports.config_player = function(config) {
	if(surf_socket == null) {
		config.socket.emit('fail', {message: 'Sorry, there is currently no game to connect to'});
	}
	else {
		surf_socket.emit('newplayer', config.username);
		
		config.socket.on('tilt', function(tilt) {
			surf_socket.emit('tilt', {username: config.username, tiltData: tilt});
		});
		
		config.socket.on('disconnect', function() {
			surf_socket.emit('playerleave', config.username);
		});
		
	}
};